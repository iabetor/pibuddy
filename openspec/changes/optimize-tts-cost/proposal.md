# Change: 优化 TTS 成本和回复流畅度

## Why

当前存在两个问题：

1. **TTS 成本浪费**：当 LLM 需要调用工具时，会先输出"我来帮你查询一下..."之类的句子，这些句子会被立即合成播放，浪费 TTS 费用。例如：
   - 用户："今天适合做什么"
   - LLM 先说："我来帮你查询一下今天的黄历信息，看看今天适合做什么。"（浪费 TTS）
   - 然后调用 `get_lunar_date` 工具
   - 最后给出实际答案

2. **回复流畅度差**：LLM 的回复是按句子流式合成的，导致回复被分成多段播放，体验不连贯。例如：
   - "今天是2026年2月15日，农历腊月廿八，乙巳年蛇年。"（停顿）
   - "根据黄历信息，今天："（停顿）
   - "**宜**：求医、治病..."（停顿）
   - ...（每句话都单独合成和播放）

## What Changes

### 1. 优化 System Prompt
- 明确指示 LLM 简洁回复
- 如果需要调用工具，直接调用，不要先说"我来帮你..."
- 回复要连贯完整，避免分段过多

### 2. 修改 processQuery 逻辑（可选，优先级低）
- **方案 A（简单）**：优化 prompt，让 LLM 自然避免铺垫
- **方案 B（复杂）**：检测到工具调用时，缓冲首句，等工具执行完再播放

**推荐方案 A**：先优化 prompt，如果效果不好再考虑方案 B。

## Impact

- **修改文件**：
  - `configs/pibuddy.yaml`（system_prompt）
  - 无需修改代码（如果方案 A 够用）
- **影响范围**：LLM 回复风格和 TTS 调用次数
- **预期效果**：
  - TTS 调用次数减少 30-50%
  - 回复更连贯流畅
  - 用户体验提升

## Success Criteria

- [ ] 工具调用场景不再有"我来帮你查询..."的前言
- [ ] 回复更简洁连贯
- [ ] TTS 调用次数明显减少
- [ ] 现有功能不受影响
